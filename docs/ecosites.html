<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Ecosites | NRCS Ecologist FAQs</title>
  <meta name="description" content="This is a compilation of FAQs for NRCS Ecologists." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Ecosites | NRCS Ecologist FAQs" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a compilation of FAQs for NRCS Ecologists." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Ecosites | NRCS Ecologist FAQs" />
  
  <meta name="twitter:description" content="This is a compilation of FAQs for NRCS Ecologists." />
  

<meta name="author" content="Nathan Roe - nateroe@gmail.com" />


<meta name="date" content="2023-06-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="components.html"/>
<link rel="next" href="species.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ESS FAQs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#odbc-connection"><i class="fa fa-check"></i><b>1.2</b> ODBC Connection</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#standard"><i class="fa fa-check"></i><b>1.3</b> Standard dataset/packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mapunits.html"><a href="mapunits.html"><i class="fa fa-check"></i><b>2</b> Mapunits</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mapunits.html"><a href="mapunits.html#mapunitsinMLRA"><i class="fa fa-check"></i><b>2.1</b> What mapunits are in an MLRA?</a></li>
<li class="chapter" data-level="2.2" data-path="mapunits.html"><a href="mapunits.html#mapunitsinSSA"><i class="fa fa-check"></i><b>2.2</b> What mapunits are in a Soil Survey Area?</a></li>
<li class="chapter" data-level="2.3" data-path="mapunits.html"><a href="mapunits.html#mapping-mapunits"><i class="fa fa-check"></i><b>2.3</b> Mapping mapunits</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="components.html"><a href="components.html"><i class="fa fa-check"></i><b>3</b> Components</a>
<ul>
<li class="chapter" data-level="3.1" data-path="components.html"><a href="components.html#componentsinMLRA"><i class="fa fa-check"></i><b>3.1</b> Identify components in MLRA?</a></li>
<li class="chapter" data-level="3.2" data-path="components.html"><a href="components.html#identify-components-in-soil-survey-area"><i class="fa fa-check"></i><b>3.2</b> Identify components in Soil Survey Area?</a></li>
<li class="chapter" data-level="3.3" data-path="components.html"><a href="components.html#existing-component-ecosite-correlations"><i class="fa fa-check"></i><b>3.3</b> Existing component, ecosite correlations</a></li>
<li class="chapter" data-level="3.4" data-path="components.html"><a href="components.html#components-correlated-to-an-ecosite-of-interest"><i class="fa fa-check"></i><b>3.4</b> Components correlated to an ecosite of interest?</a></li>
<li class="chapter" data-level="3.5" data-path="components.html"><a href="components.html#ecological-characteristics-of-components-non-programmatic"><i class="fa fa-check"></i><b>3.5</b> Ecological characteristics of components? (non-programmatic)</a></li>
<li class="chapter" data-level="3.6" data-path="components.html"><a href="components.html#ecological-characteristics-of-components-programmatic"><i class="fa fa-check"></i><b>3.6</b> Ecological characteristics of components? (programmatic)</a></li>
<li class="chapter" data-level="3.7" data-path="components.html"><a href="components.html#where-do-components-occur"><i class="fa fa-check"></i><b>3.7</b> Where do components occur?</a></li>
<li class="chapter" data-level="3.8" data-path="components.html"><a href="components.html#how-to-correlate-components-to-ecosites"><i class="fa fa-check"></i><b>3.8</b> How to correlate components to ecosites?</a></li>
<li class="chapter" data-level="3.9" data-path="components.html"><a href="components.html#how-to-qc-the-correlation-between"><i class="fa fa-check"></i><b>3.9</b> How to QC the correlation between</a></li>
<li class="chapter" data-level="3.10" data-path="components.html"><a href="components.html#test-section"><i class="fa fa-check"></i><b>3.10</b> Test section</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ecosites.html"><a href="ecosites.html"><i class="fa fa-check"></i><b>4</b> Ecosites</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ecosites.html"><a href="ecosites.html#what-ecosites-are-active-in-an-mlra"><i class="fa fa-check"></i><b>4.1</b> What ecosites are active in an MLRA?</a></li>
<li class="chapter" data-level="4.2" data-path="ecosites.html"><a href="ecosites.html#range-in-characteristics-of-ecosites"><i class="fa fa-check"></i><b>4.2</b> Range in characteristics of ecosites</a></li>
<li class="chapter" data-level="4.3" data-path="ecosites.html"><a href="ecosites.html#mapping-ecological-sites"><i class="fa fa-check"></i><b>4.3</b> Mapping ecological sites</a></li>
<li class="chapter" data-level="4.4" data-path="ecosites.html"><a href="ecosites.html#associated-sites"><i class="fa fa-check"></i><b>4.4</b> Associated sites</a></li>
<li class="chapter" data-level="4.5" data-path="ecosites.html"><a href="ecosites.html#determine-acreage-of-single-ecological-site"><i class="fa fa-check"></i><b>4.5</b> Determine acreage of single ecological site</a></li>
<li class="chapter" data-level="4.6" data-path="ecosites.html"><a href="ecosites.html#determine-acreage-of-multiple-ecological-sites"><i class="fa fa-check"></i><b>4.6</b> Determine acreage of multiple ecological sites</a></li>
<li class="chapter" data-level="4.7" data-path="ecosites.html"><a href="ecosites.html#plotveg"><i class="fa fa-check"></i><b>4.7</b> Accessing plot level vegetation data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="species.html"><a href="species.html"><i class="fa fa-check"></i><b>5</b> Species</a>
<ul>
<li class="chapter" data-level="5.1" data-path="species.html"><a href="species.html#mapping-the-location-of-species"><i class="fa fa-check"></i><b>5.1</b> Mapping the location of species</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nasis.html"><a href="nasis.html"><i class="fa fa-check"></i><b>6</b> NASIS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nasis.html"><a href="nasis.html#creating-a-static-nasis-database"><i class="fa fa-check"></i><b>6.1</b> Creating a Static NASIS database</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="package-buildingmaintaining-tips.html"><a href="package-buildingmaintaining-tips.html"><i class="fa fa-check"></i><b>7</b> Package building/maintaining tips</a>
<ul>
<li class="chapter" data-level="7.1" data-path="package-buildingmaintaining-tips.html"><a href="package-buildingmaintaining-tips.html#package-buildingmaintaining-tips-1"><i class="fa fa-check"></i><b>7.1</b> Package building/maintaining tips</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NRCS Ecologist FAQs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ecosites" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Ecosites<a href="ecosites.html#ecosites" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-ecosites-are-active-in-an-mlra" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> What ecosites are active in an MLRA?<a href="ecosites.html#what-ecosites-are-active-in-an-mlra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>Then, we simply need to call the ecosite IDs or ecosite names, depending on your preference. Remember, remove <code>head()</code> to see the full list.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ecosites.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA<span class="sc">$</span>ecosite_id)</span></code></pre></div>
<pre><code>## [1] NA NA NA NA NA NA</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="ecosites.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA<span class="sc">$</span>ecosite_name)</span></code></pre></div>
<pre><code>## [1] NA NA NA NA NA NA</code></pre>
<p>There are likely NAs (missing values) in the above list. This is because the above considers components are are minor and miscellaneous. We do not correlate ecosites to components that are minor and miscellaneous. It will likely be more useful to remove minor and miscellaneous componets:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="ecosites.html#cb47-1" aria-hidden="true" tabindex="-1"></a>my.components.MLRA.reduced <span class="ot">&lt;-</span> my.components.MLRA <span class="sc">%&gt;%</span> aqp<span class="sc">::</span><span class="fu">site</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="ecosites.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(compkind <span class="sc">!=</span> <span class="st">&quot;miscellaneous area&quot;</span> <span class="sc">&amp;</span> majcompflag <span class="sc">==</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb47-3"><a href="ecosites.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA.reduced<span class="sc">$</span>ecosite_id)</span></code></pre></div>
<pre><code>## [1] &quot;R017XE041CA&quot; &quot;R017XY901CA&quot; &quot;R017XY902CA&quot; &quot;R017XY903CA&quot; &quot;R017XY903CA&quot;
## [6] &quot;R017XY904CA&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="ecosites.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA.reduced<span class="sc">$</span>ecosite_name)</span></code></pre></div>
<pre><code>## [1] &quot;Fine Loamy 8-10\&quot; P.Z.&quot;          &quot;Clayey Basin Group&quot;             
## [3] &quot;Duripan Vernal Pools&quot;            &quot;Stream Channels and Floodplains&quot;
## [5] &quot;Stream Channels and Floodplains&quot; &quot;Subirrigated Deep Alluvial Fans&quot;</code></pre>
<p>We might also be interested to see how often different ecosites are used:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ecosites.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(my.components.MLRA.reduced<span class="sc">$</span>ecosite_id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="ecosites.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Ecosite =</span> Var1) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Freq)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##       Ecosite Freq
## 1 R017XY902CA  418
## 2 F022AW007CA  398
## 3 R017XY905CA  305
## 4 R017XY903CA  290
## 5 R017XY904CA  225
## 6 F018XC201CA  201</code></pre>
<p>Interesting… the most used ecosites in MLRA18 are ecosite concepts from MLRAs 22a and 17.</p>
</div>
<div id="range-in-characteristics-of-ecosites" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Range in characteristics of ecosites<a href="ecosites.html#range-in-characteristics-of-ecosites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I created a report that summarizes the characteristics of ecosites. It is organized based on the information that is supposed to be populated in EDIT. Here is a link to a <a href="https://htmlpreview.github.io/?https://github.com/natearoe/practice/blob/master/F018XA201CA.html">sample report</a>. I have established a methodology allowing you to create reports like the one linked for all of the ecosites in your MLRA within a few short steps. You can also produce the report for just one of your ecosites. For documentation on this methodology, <a href="https://natearoe.github.io/git-cloud-storage/read_me.docx">click here</a>. Click on the green ‘Code’ button and choose ‘Download ZIP’. Once you have downloaded to the location of your preference, you can right click &gt; Extract all. You can then open the read_me.docx file. Additionally, you can watch the following YouTube video:</p>
<iframe src="https://www.youtube.com/embed/9H8sz5fZaEQ?start=19" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="mapping-ecological-sites" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Mapping ecological sites<a href="ecosites.html#mapping-ecological-sites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this methodology, the ecological site is mapped in all map units containing a component correlated to the ecological site. The alternative would be to map the ecological site only in map units where the dominant component is correlated to the ecological site of interest. I am more interest in the full extent of the ecological site, so I am using the less restrictive of the two.</p>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>Load a shapefile of your map unit boundaries (the MLRA boundaries cover the whole country, but you will have to change the map unit boundaries to your local map unit shapefile)</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ecosites.html#cb53-1" aria-hidden="true" tabindex="-1"></a>mapunit_boundaries <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">&quot;C:/Users/Nathan.Roe/Documents/PES/gSSURGO_CA_2022.gdb&quot;</span>,</span>
<span id="cb53-2"><a href="ecosites.html#cb53-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;mupolygon&quot;</span>)</span>
<span id="cb53-3"><a href="ecosites.html#cb53-3" aria-hidden="true" tabindex="-1"></a>mlra_boundaries <span class="ot">&lt;-</span> </span>
<span id="cb53-4"><a href="ecosites.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">&quot;C:/Users/Nathan.Roe/Documents/PES/MLRA_52_2022/MLRA_52_2022/MLRA_52.shp&quot;</span>)</span></code></pre></div>
<p>What is your ecological site of interest? (change appropriate to your project)</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="ecosites.html#cb54-1" aria-hidden="true" tabindex="-1"></a>ecosite_of_interest <span class="ot">&lt;-</span> <span class="st">&quot;R018XE104CA&quot;</span></span></code></pre></div>
<p>What is your MLRA of interest? (change appropriate to your project)</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ecosites.html#cb55-1" aria-hidden="true" tabindex="-1"></a>mlra_of_interest <span class="ot">&lt;-</span> <span class="dv">18</span></span></code></pre></div>
<p>Reduce component data to those associated with ecosite of interest</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="ecosites.html#cb56-1" aria-hidden="true" tabindex="-1"></a>my.components.MLRA.reduced <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">site</span>(my.components.MLRA) <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="ecosites.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ecosite_id <span class="sc">==</span> ecosite_of_interest)</span></code></pre></div>
<p>Reduce mapunits to those associated with ecosite of interest</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="ecosites.html#cb57-1" aria-hidden="true" tabindex="-1"></a>mapunit_boundaries_of_interest <span class="ot">&lt;-</span> mapunit_boundaries <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="ecosites.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(MUKEY <span class="sc">%in%</span> my.components.MLRA.reduced<span class="sc">$</span>muiid) <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="ecosites.html#cb57-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span></code></pre></div>
<p>Reduce MLRA boundary to MLRA of interest</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="ecosites.html#cb58-1" aria-hidden="true" tabindex="-1"></a>mlra_boundaries_reduced <span class="ot">&lt;-</span> mlra_boundaries <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="ecosites.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(MLRARSYM <span class="sc">==</span> mlra_of_interest) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="ecosites.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span></code></pre></div>
<p>Select state of interest (change appropriate to your project, you could select multiple states too)</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="ecosites.html#cb59-1" aria-hidden="true" tabindex="-1"></a>ca <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">&quot;state&quot;</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="ecosites.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">&quot;california&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="ecosites.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span></code></pre></div>
<p>Plot map</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="ecosites.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ca) <span class="sc">+</span> </span>
<span id="cb60-2"><a href="ecosites.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mlra_boundaries_reduced) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="ecosites.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapunit_boundaries_of_interest,</span>
<span id="cb60-4"><a href="ecosites.html#cb60-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">&quot;hotpink&quot;</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="ecosites.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Distribution of ecological site - &quot;</span>, ecosite_of_interest))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
<div id="associated-sites" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Associated sites<a href="ecosites.html#associated-sites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Associated sites are ecological sites that occur in the same area of the landscape. The simplest way to think about this is ecological sites that are adjacent to your ecological site of interest. I am going to present a simple way of addressing this. We can determine what ecological sites occur in the same mapunit as your ecosite of interest. Looking at all the mapunits that your ecological site of interest occurs in, and tallying up all of the other ecological sites that are in shared mapunits, we can come to a metric of what other ecological sites tend to be near your ecological site of interest. In the future, I would like to make some improvements to this, so that it considers adjacent mapunits and considers the length of boundary between mapunits.</p>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>Reduce data how you see fit. I am just going to remove miscellaneous areas, but you could choose additional criteria such as removing minor components.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="ecosites.html#cb61-1" aria-hidden="true" tabindex="-1"></a>my.components.MLRA.reduced <span class="ot">&lt;-</span> my.components.MLRA<span class="sc">@</span>site <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(compkind <span class="sc">!=</span> <span class="st">&quot;miscellaneous area&quot;</span>)</span></code></pre></div>
<p>Calculate the acreage associated with each component</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="ecosites.html#cb62-1" aria-hidden="true" tabindex="-1"></a>my.components.MLRA.reduced<span class="sc">$</span>comp_acres <span class="ot">&lt;-</span> (my.components.MLRA.reduced<span class="sc">$</span>muacres <span class="sc">*</span> my.components.MLRA.reduced<span class="sc">$</span>comppct_r)<span class="sc">/</span><span class="dv">100</span></span></code></pre></div>
<p>Create empty list for upcoming for loop</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="ecosites.html#cb63-1" aria-hidden="true" tabindex="-1"></a>associated_ecosites <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code></pre></div>
<p>Create for loop to calculate the acreage of ecosites that occur in the same mapunits as your ecosite of interest. The results will be in a list.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="ecosites.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> my.components.MLRA.reduced<span class="sc">$</span>ecosite_id <span class="sc">|&gt;</span> <span class="fu">unique</span>()){</span>
<span id="cb64-2"><a href="ecosites.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  associated_ecosites[[i]] <span class="ot">&lt;-</span> my.components.MLRA.reduced <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a href="ecosites.html#cb64-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(mukey <span class="sc">%in%</span> (my.components.MLRA.reduced <span class="sc">|&gt;</span> </span>
<span id="cb64-4"><a href="ecosites.html#cb64-4" aria-hidden="true" tabindex="-1"></a>                    dplyr<span class="sc">::</span><span class="fu">filter</span>(ecosite_id <span class="sc">==</span> i) <span class="sc">|&gt;</span> </span>
<span id="cb64-5"><a href="ecosites.html#cb64-5" aria-hidden="true" tabindex="-1"></a>                    dplyr<span class="sc">::</span><span class="fu">pull</span>(mukey))) <span class="sc">|&gt;</span> </span>
<span id="cb64-6"><a href="ecosites.html#cb64-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(ecosite_id) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">acres =</span> <span class="fu">sum</span>(comp_acres)) <span class="sc">|&gt;</span> </span>
<span id="cb64-7"><a href="ecosites.html#cb64-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(ecosite_id <span class="sc">!=</span> i) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(acres))</span>
<span id="cb64-8"><a href="ecosites.html#cb64-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s take a look at an example</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="ecosites.html#cb65-1" aria-hidden="true" tabindex="-1"></a>associated_ecosites<span class="sc">$</span>F018XA202CA</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   ecosite_id   acres
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 R018XA103CA 14813.
## 2 R018XA104CA  8784.
## 3 R015XF008CA  1657</code></pre>
</div>
<div id="determine-acreage-of-single-ecological-site" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Determine acreage of single ecological site<a href="ecosites.html#determine-acreage-of-single-ecological-site" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>My office leader recently asked me how many acres a particular ecological site occupies because she was entering it as a project in NASIS and needed the associated acres. You might need to do something similar for a NASIS project, a tech team meeting, or to improve your own understanding of how prevalent an ecological site is.</p>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>First, let’s say we have a particular ecosite of interest - “R018XI105CA”</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="ecosites.html#cb67-1" aria-hidden="true" tabindex="-1"></a>my_ecosite <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">site</span>(my.components.MLRA) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ecosite_id <span class="sc">==</span> <span class="st">&quot;R018XI105CA&quot;</span>)</span></code></pre></div>
<p>Now let’s look at the components correlated to our ecosite of interest, the component percent (percent of mapunit represented by component), the mapunit acres, and calculate the acres associated with each component by multiplying component percent and mapunit acres.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="ecosites.html#cb68-1" aria-hidden="true" tabindex="-1"></a>my_ecosite_compacres <span class="ot">&lt;-</span> my_ecosite <span class="sc">%&gt;%</span> <span class="fu">select</span>(ecosite_id, coiid, comppct_r, muacres) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">comp_acreage =</span> (comppct_r<span class="sc">/</span><span class="dv">100</span>)<span class="sc">*</span>muacres)</span>
<span id="cb68-2"><a href="ecosites.html#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="ecosites.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_ecosite_compacres)</span></code></pre></div>
<pre><code>##    ecosite_id   coiid comppct_r muacres comp_acreage
## 1 R018XI105CA 2516892        25    5717      1429.25
## 2 R018XI105CA 2029027        10   34449      3444.90
## 3 R018XI105CA 2500528        17   34449      5856.33
## 4 R018XI105CA 1842728        25    7447      1861.75
## 5 R018XI105CA 2029025        10    7447       744.70
## 6 R018XI105CA 2482828        15   22906      3435.90</code></pre>
<p>Then, we just need to sum the comp_acreage</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="ecosites.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(my_ecosite_compacres<span class="sc">$</span>comp_acreage)</span></code></pre></div>
<pre><code>## [1] 85585.38</code></pre>
</div>
<div id="determine-acreage-of-multiple-ecological-sites" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Determine acreage of multiple ecological sites<a href="ecosites.html#determine-acreage-of-multiple-ecological-sites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s look at how we would efficiently calculate the acreage of all the ecosites in your MLRA.</p>
<p>First, we will restrict the ecosites of interest to only those associate with MLRA 18.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="ecosites.html#cb72-1" aria-hidden="true" tabindex="-1"></a>MLRA18_ecosites <span class="ot">&lt;-</span> my.components.MLRA<span class="sc">$</span>ecosite_id <span class="sc">%&gt;%</span> <span class="fu">str_subset</span>(<span class="at">pattern =</span> <span class="st">&quot;18X&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span></code></pre></div>
<p>Now we can run a for loop that goes through each ecological site, calculates the acreage, and puts them all in a data frame</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="ecosites.html#cb73-1" aria-hidden="true" tabindex="-1"></a>ecosite_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb73-2"><a href="ecosites.html#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="ecosites.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> MLRA18_ecosites){</span>
<span id="cb73-4"><a href="ecosites.html#cb73-4" aria-hidden="true" tabindex="-1"></a>  ecosite_list[[i]] <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">site</span>(my.components.MLRA) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ecosite_id <span class="sc">==</span> i) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ecosite_id, coiid, comppct_r, muacres) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="ecosites.html#cb73-5" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">mutate</span>(<span class="at">comp_acreage =</span> (comppct_r<span class="sc">/</span><span class="dv">100</span>)<span class="sc">*</span>muacres) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Ecosite =</span> <span class="fu">first</span>(ecosite_id), <span class="at">Acreage =</span></span>
<span id="cb73-6"><a href="ecosites.html#cb73-6" aria-hidden="true" tabindex="-1"></a>                                                                                                           <span class="fu">sum</span>(comp_acreage))</span>
<span id="cb73-7"><a href="ecosites.html#cb73-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-8"><a href="ecosites.html#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="ecosites.html#cb73-9" aria-hidden="true" tabindex="-1"></a>MLRA18_ecosite_acreage <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, ecosite_list) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>()</span>
<span id="cb73-10"><a href="ecosites.html#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="ecosites.html#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MLRA18_ecosite_acreage)</span></code></pre></div>
<pre><code>##       Ecosite   Acreage
## 1 R018XI163CA 251072.59
## 2 R018XI164CA  38683.76
## 3 F018XI200CA 406409.32
## 4 R018XA102CA   8555.35
## 5 F018XA201CA  32945.32
## 6 F018XI201CA 364947.53</code></pre>
</div>
<div id="plotveg" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Accessing plot level vegetation data<a href="ecosites.html#plotveg" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This requires a bit of Querying magic. The Query that we want is MLRA13_Wasilla &gt; ‘Pedon/Site/Vegetation Plot by area overlap type and areasym’. The description for this Query gives the necessary details.</p>
<p>NATIONAL: Have to run this twice against the national in order to get sites, pedons, and vegetation plot. First, set target table to PEDON. Second, set target tablet to VEGETATION PLOT.</p>
<p>LOCAL: Set target tablest to PEDON, SITE, and VEGETATION PLOT.</p>
<ol style="list-style-type: decimal">
<li><p>Run against National - Pedon
<img src="_book/veg_plot_national_pedon.JPG" alt="Run against National Vegplot Pedon" /></p></li>
<li><p>Run against National - Vegetation plot
<img src="_book/veg_plot_national_vegplot.JPG" alt="Run against National Vegplot Vegetation Plot" /></p></li>
<li><p>Run against Local
<img src="_book/veg_plot_local.JPG" alt="Run against local Vegplot" /></p></li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="ecosites.html#cb75-1" aria-hidden="true" tabindex="-1"></a>veg_data <span class="ot">&lt;-</span> <span class="fu">fetchVegdata</span>(<span class="at">SS =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>I will return to this to provide some tools for dealing with the actual veg data.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="ecosites.html#cb76-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">UserSiteID =</span> veg_data<span class="sc">$</span>vegplot<span class="sc">$</span>site_id, <span class="at">DataOrigin =</span> veg_data<span class="sc">$</span>vegplot<span class="sc">$</span>vegdataorigin)</span>
<span id="cb76-2"><a href="ecosites.html#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="ecosites.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test<span class="sc">$</span>DataOrigin)</span></code></pre></div>
<pre><code>## 
## site existing veg table        spreadsheet form 
##                     470                     880</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="components.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="species.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-ecosites.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
