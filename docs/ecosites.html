<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Ecosites | NRCS Ecologist FAQs</title>
  <meta name="description" content="This is a compilation of FAQs for NRCS Ecologists." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Ecosites | NRCS Ecologist FAQs" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a compilation of FAQs for NRCS Ecologists." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Ecosites | NRCS Ecologist FAQs" />
  
  <meta name="twitter:description" content="This is a compilation of FAQs for NRCS Ecologists." />
  

<meta name="author" content="Nathan Roe - nateroe@gmail.com" />


<meta name="date" content="2022-05-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="components.html"/>
<link rel="next" href="footnotes-and-citations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ESS FAQs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#obcd-connection"><i class="fa fa-check"></i><b>1.2</b> OBCD Connection<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#standard"><i class="fa fa-check"></i><b>1.3</b> Standard dataset/packages<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mapunits.html"><a href="mapunits.html"><i class="fa fa-check"></i><b>2</b> Mapunits<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="mapunits.html"><a href="mapunits.html#mapunitsinMLRA"><i class="fa fa-check"></i><b>2.1</b> What mapunits are in an MLRA?<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="mapunits.html"><a href="mapunits.html#mapunitsinSSA"><i class="fa fa-check"></i><b>2.2</b> What mapunits are in a Soil Survey Area?<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="mapunits.html"><a href="mapunits.html#mapping-mapunits"><i class="fa fa-check"></i><b>2.3</b> Mapping mapunits<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="components.html"><a href="components.html"><i class="fa fa-check"></i><b>3</b> Components<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="components.html"><a href="components.html#componentsinMLRA"><i class="fa fa-check"></i><b>3.1</b> Identify components in MLRA?<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="components.html"><a href="components.html#identify-components-in-soil-survey-area"><i class="fa fa-check"></i><b>3.2</b> Identify components in Soil Survey Area?<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="components.html"><a href="components.html#existing-component-ecosite-correlations"><i class="fa fa-check"></i><b>3.3</b> Existing component, ecosite correlations<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="components.html"><a href="components.html#components-correlated-to-an-ecosite-of-interest"><i class="fa fa-check"></i><b>3.4</b> Components correlated to an ecosite of interest?<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="components.html"><a href="components.html#ecological-characteristics-of-components-non-programmatic"><i class="fa fa-check"></i><b>3.5</b> Ecological characteristics of components? (non-programmatic)<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="components.html"><a href="components.html#ecological-characteristics-of-components-programmatic"><i class="fa fa-check"></i><b>3.6</b> Ecological characteristics of components? (programmatic)<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="components.html"><a href="components.html#where-do-components-occur"><i class="fa fa-check"></i><b>3.7</b> Where do components occur?<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="components.html"><a href="components.html#how-to-correlate-components-to-ecosites"><i class="fa fa-check"></i><b>3.8</b> How to correlate components to ecosites?<span></span></a></li>
<li class="chapter" data-level="3.9" data-path="components.html"><a href="components.html#how-to-qc-the-correlation-between"><i class="fa fa-check"></i><b>3.9</b> How to QC the correlation between<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ecosites.html"><a href="ecosites.html"><i class="fa fa-check"></i><b>4</b> Ecosites<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="ecosites.html"><a href="ecosites.html#what-ecosites-are-active-in-an-mlra"><i class="fa fa-check"></i><b>4.1</b> What ecosites are active in an MLRA?<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="ecosites.html"><a href="ecosites.html#range-in-characteristics-of-ecosites"><i class="fa fa-check"></i><b>4.2</b> Range in characteristics of ecosites<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="ecosites.html"><a href="ecosites.html#mapping-ecological-sites"><i class="fa fa-check"></i><b>4.3</b> Mapping ecological sites<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="ecosites.html"><a href="ecosites.html#associated-sites"><i class="fa fa-check"></i><b>4.4</b> Associated sites<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="ecosites.html"><a href="ecosites.html#non-rep-dmu-components-correlated-to-ecosites"><i class="fa fa-check"></i><b>4.5</b> Non-rep dmu components correlated to ecosites<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html"><i class="fa fa-check"></i><b>5</b> Footnotes and citations<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#footnotes"><i class="fa fa-check"></i><b>5.1</b> Footnotes<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#citations"><i class="fa fa-check"></i><b>5.2</b> Citations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>6</b> Blocks<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>6.1</b> Equations<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>6.2</b> Theorems and proofs<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>6.3</b> Callout blocks<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>7</b> Sharing your book<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>7.1</b> Publishing<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>7.2</b> 404 pages<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>7.3</b> Metadata for sharing<span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NRCS Ecologist FAQs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ecosites" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Ecosites<a href="ecosites.html#ecosites" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-ecosites-are-active-in-an-mlra" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> What ecosites are active in an MLRA?<a href="ecosites.html#what-ecosites-are-active-in-an-mlra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>Then, we simply need to call the ecosite IDs or ecosite names, depending on your preference. Remember, remove <code>head()</code> to see the full list.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="ecosites.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA<span class="sc">$</span>ecosite_id)</span></code></pre></div>
<pre><code>## [1] &quot;R018XA103CA&quot; &quot;R018XA103CA&quot; &quot;R018XA104CA&quot; &quot;F018XA202CA&quot; &quot;R015XE001CA&quot;
## [6] &quot;R015XE026CA&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="ecosites.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA<span class="sc">$</span>ecosite_name)</span></code></pre></div>
<pre><code>## [1] &quot;Shallow  Thermic Volcanic Ridges 30- 40 PZ&quot;    
## [2] &quot;Shallow  Thermic Volcanic Ridges 30- 40 PZ&quot;    
## [3] &quot;Shallow Mesic Volcanic Ridges 39 - 49 PZ&quot;      
## [4] &quot;Deep Mesic Mountain Slopes &amp; Summits 40- 55 PZ&quot;
## [5] &quot;Clayey Hills 10-14\&quot; p.z.&quot;                     
## [6] &quot;Loamy Slopes 9-12\&quot; p.z.&quot;</code></pre>
<p>There are likely NAs (missing values) in the above list. This is because the above considers components are are minor and miscellaneous. We do not correlate ecosites to components that are minor and miscellaneous. It will likely be more useful to remove minor and miscellaneous componets:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ecosites.html#cb37-1" aria-hidden="true" tabindex="-1"></a>my.components.MLRA.reduced <span class="ot">&lt;-</span> my.components.MLRA <span class="sc">%&gt;%</span> aqp<span class="sc">::</span><span class="fu">site</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="ecosites.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(compkind <span class="sc">!=</span> <span class="st">&quot;miscellaneous area&quot;</span> <span class="sc">&amp;</span> majcompflag <span class="sc">==</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb37-3"><a href="ecosites.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA.reduced<span class="sc">$</span>ecosite_id)</span></code></pre></div>
<pre><code>## [1] &quot;R018XA103CA&quot; &quot;R018XA103CA&quot; &quot;R018XA104CA&quot; &quot;F018XA202CA&quot; &quot;R015XE001CA&quot;
## [6] &quot;R015XE026CA&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ecosites.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my.components.MLRA.reduced<span class="sc">$</span>ecosite_name)</span></code></pre></div>
<pre><code>## [1] &quot;Shallow  Thermic Volcanic Ridges 30- 40 PZ&quot;    
## [2] &quot;Shallow  Thermic Volcanic Ridges 30- 40 PZ&quot;    
## [3] &quot;Shallow Mesic Volcanic Ridges 39 - 49 PZ&quot;      
## [4] &quot;Deep Mesic Mountain Slopes &amp; Summits 40- 55 PZ&quot;
## [5] &quot;Clayey Hills 10-14\&quot; p.z.&quot;                     
## [6] &quot;Loamy Slopes 9-12\&quot; p.z.&quot;</code></pre>
<p>We might also be interested to see how often different ecosites are used:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="ecosites.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(my.components.MLRA.reduced<span class="sc">$</span>ecosite_id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="ecosites.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Ecosite =</span> Var1) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Freq)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##       Ecosite Freq
## 1 F022AW007CA  413
## 2 R017XY902CA  410
## 3 R017XY905CA  287
## 4 R017XY903CA  251
## 5 R017XY904CA  215
## 6 F018XC201CA  155</code></pre>
<p>Interesting… the most used ecosites in MLRA18 are ecosite concepts from MLRAs 22a and 17.</p>
</div>
<div id="range-in-characteristics-of-ecosites" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Range in characteristics of ecosites<a href="ecosites.html#range-in-characteristics-of-ecosites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I created a report that summarizes the characteristics of ecosites. It is organized based on the information that is supposed to be populated in EDIT. Here is a link to a <a href="https://htmlpreview.github.io/?https://github.com/natearoe/practice/blob/master/F018XA201CA.html">sample report</a>. I have established a methodology allowing you to create reports like the one linked for all of the ecosites in your MLRA within a few short steps. You can also produce the report for just one of your ecosites. For documentation on this methodology, <a href="https://natearoe.github.io/git-cloud-storage/read_me.docx">click here</a>. Click on the green ‘Code’ button and choose ‘Download ZIP.’ Once you have downloaded to the location of your preference, you can right click &gt; Extract all. You can then open the read_me.docx file. Additionally, you can watch the following YouTube video:</p>
<iframe src="https://www.youtube.com/embed/9H8sz5fZaEQ?start=19" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="mapping-ecological-sites" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Mapping ecological sites<a href="ecosites.html#mapping-ecological-sites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this methodology, the ecological site is mapped in all map units containing a component correlated to the ecological site. The alternative would be to map the ecological site only in map units where the dominant component is correlated to the ecological site of interest. I am more interest in the full extent of the ecological site, so I am using the less restrictive of the two.</p>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>Load a shapefile of your map unit boundaries (the MLRA boundaries cover the whole country, but you will have to change the map unit boundaries to your local map unit shapefile)</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ecosites.html#cb43-1" aria-hidden="true" tabindex="-1"></a>mapunit_boundaries <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">&quot;C:/Users/Nathan.Roe/Documents/PES/gSSURGO_CA_2022.gdb&quot;</span>,</span>
<span id="cb43-2"><a href="ecosites.html#cb43-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;mupolygon&quot;</span>)</span>
<span id="cb43-3"><a href="ecosites.html#cb43-3" aria-hidden="true" tabindex="-1"></a>mlra_boundaries <span class="ot">&lt;-</span> </span>
<span id="cb43-4"><a href="ecosites.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">&quot;C:/Users/Nathan.Roe/Documents/PES/MLRA_52_2022/MLRA_52_2022/MLRA_52.shp&quot;</span>)</span></code></pre></div>
<p>What is your ecological site of interest? (change appropriate to your project)</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="ecosites.html#cb44-1" aria-hidden="true" tabindex="-1"></a>ecosite_of_interest <span class="ot">&lt;-</span> <span class="st">&quot;R018XE104CA&quot;</span></span></code></pre></div>
<p>What is your MLRA of interest? (change appropriate to your project)</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="ecosites.html#cb45-1" aria-hidden="true" tabindex="-1"></a>mlra_of_interest <span class="ot">&lt;-</span> <span class="dv">18</span></span></code></pre></div>
<p>Reduce component data to those associated with ecosite of interest</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="ecosites.html#cb46-1" aria-hidden="true" tabindex="-1"></a>my.components.MLRA.reduced <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">site</span>(my.components.MLRA) <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="ecosites.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ecosite_id <span class="sc">==</span> ecosite_of_interest)</span></code></pre></div>
<p>Reduce mapunits to those associated with ecosite of interest</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="ecosites.html#cb47-1" aria-hidden="true" tabindex="-1"></a>mapunit_boundaries_of_interest <span class="ot">&lt;-</span> mapunit_boundaries <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="ecosites.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(MUKEY <span class="sc">%in%</span> my.components.MLRA.reduced<span class="sc">$</span>muiid) <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="ecosites.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span></code></pre></div>
<p>Reduce MLRA boundary to MLRA of interest</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="ecosites.html#cb48-1" aria-hidden="true" tabindex="-1"></a>mlra_boundaries_reduced <span class="ot">&lt;-</span> mlra_boundaries <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="ecosites.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(MLRARSYM <span class="sc">==</span> mlra_of_interest) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="ecosites.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span></code></pre></div>
<p>Select state of interest (change appropriate to your project, you could select multiple states too)</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="ecosites.html#cb49-1" aria-hidden="true" tabindex="-1"></a>ca <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">&quot;state&quot;</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="ecosites.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ID <span class="sc">==</span> <span class="st">&quot;california&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="ecosites.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span></code></pre></div>
<p>Plot map</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="ecosites.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ca) <span class="sc">+</span> </span>
<span id="cb50-2"><a href="ecosites.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mlra_boundaries_reduced) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="ecosites.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapunit_boundaries_of_interest,</span>
<span id="cb50-4"><a href="ecosites.html#cb50-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">&quot;hotpink&quot;</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb50-5"><a href="ecosites.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Distribution of ecological site - &quot;</span>, ecosite_of_interest))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="associated-sites" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Associated sites<a href="ecosites.html#associated-sites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Associated sites are ecological sites that occur in the same area of the landscape. The simplest way to think about this is ecological sites that are adjacent to your ecological site of interest. I am going to present a simple way of addressing this. We can determine what ecological sites occur in the same mapunit as your ecosite of interest. Looking at all the mapunits that your ecological site of interest occurs in, and tallying up all of the other ecological sites that are in shared mapunits, we can come to a metric of what other ecological sites tend to be near your ecological site of interest. In the future, I would like to make some improvements to this, so that it considers adjacent mapunits and considers the length of boundary between mapunits.</p>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>Reduce data to major components and non-miscellaneous area</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ecosites.html#cb51-1" aria-hidden="true" tabindex="-1"></a>my.components.MLRA.reduced <span class="ot">&lt;-</span> my.components.MLRA <span class="sc">%&gt;%</span> <span class="fu">site</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="ecosites.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(compkind <span class="sc">!=</span> <span class="st">&quot;miscellaneous area&quot;</span> <span class="sc">&amp;</span> majcompflag <span class="sc">==</span> <span class="st">&quot;1&quot;</span>)</span></code></pre></div>
<p>Reduce to only MLRA18 ecosites</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="ecosites.html#cb52-1" aria-hidden="true" tabindex="-1"></a>MLRA18_ecosites <span class="ot">&lt;-</span>  my.components.MLRA.reduced<span class="sc">$</span>ecosite_id <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="ecosites.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_subset</span>(<span class="st">&quot;18X&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() </span></code></pre></div>
<p>Create empty lists for upcoming for loops</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ecosites.html#cb53-1" aria-hidden="true" tabindex="-1"></a>ecosite_mukeys_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb53-2"><a href="ecosites.html#cb53-2" aria-hidden="true" tabindex="-1"></a>mus_with_ecosite_list <span class="ot">&lt;-</span>  <span class="fu">list</span>()</span></code></pre></div>
<p>Create for loop to determine all the mapunits that each ecological site occurs in</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="ecosites.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> MLRA18_ecosites){</span>
<span id="cb54-2"><a href="ecosites.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  ecosite_mukeys_list[[i]] <span class="ot">&lt;-</span>  my.components.MLRA.reduced <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="ecosites.html#cb54-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(ecosite_id <span class="sc">==</span> i) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(mukey)</span>
<span id="cb54-4"><a href="ecosites.html#cb54-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Create a list of dataframes. Each dataframe has the name of the ecological site that it represents. The dataframes contain all of the component data from all of the mapunits that the ecosite occurs in. For example, let’s say we have an ecosite named F018XA201CA. The dataframe for F018XA201CA will contain data for all the components that occur in all of the mapunits that F018XA201CA occurs in. That means that many of the components will be components correlated to F018XA201CA, but it will also contain other components not correlated to F018XA201CA.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ecosites.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> MLRA18_ecosites){</span>
<span id="cb55-2"><a href="ecosites.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  mus_with_ecosite_list[[i]] <span class="ot">&lt;-</span> my.components.MLRA.reduced <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="ecosites.html#cb55-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(mukey <span class="sc">%in%</span> ecosite_mukeys_list[[i]])</span>
<span id="cb55-4"><a href="ecosites.html#cb55-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, we make a table from all of the ecological site data in each dataframe.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="ecosites.html#cb56-1" aria-hidden="true" tabindex="-1"></a>associated_sites <span class="ot">&lt;-</span>  <span class="fu">lapply</span>(mus_with_ecosite_list, <span class="at">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb56-2"><a href="ecosites.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(x<span class="sc">$</span>ecosite_id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Freq)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="ecosites.html#cb56-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Ecosite =</span> Var1)</span>
<span id="cb56-4"><a href="ecosites.html#cb56-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>The result is this list called associated_sites. associated_lists has a dataframe for every ecological site, ordered by how frequently the other ecologica sites occur. The table describes all the other ecological sites that occur in the same mapunit as the defined ecological site.</p>
<p>Let’s take a look at an example</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="ecosites.html#cb57-1" aria-hidden="true" tabindex="-1"></a>associated_sites<span class="sc">$</span>F018XA202CA</span></code></pre></div>
<pre><code>##       Ecosite Freq
## 1 F018XA202CA   19
## 2 R018XA103CA    6
## 3 R018XA104CA    3</code></pre>
<p>Here, we can see that we are looking at the ecological site F018XA202CA. The ecological site that most commonly occurs in mapunits containing your ecological site……is your ecological site. That will likely always be the case. The other ecological sites it appears with are R018XA103CA and R018XA104CA - those are actually informative.</p>
</div>
<div id="non-rep-dmu-components-correlated-to-ecosites" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Non-rep dmu components correlated to ecosites<a href="ecosites.html#non-rep-dmu-components-correlated-to-ecosites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is a good chance you have components from non-rep data map units (dmus) correlated to ecological sites. These should not exist. Non-rep dmus are more of a historical record of previous map units. Removing these correlations should be a standard part of QC.</p>
<p>Load the <a href="index.html#standard">Standard Dataset and packages</a>.</p>
<p>Look for nonrep dmus with ecosites assigned</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="ecosites.html#cb59-1" aria-hidden="true" tabindex="-1"></a>nonrep_with_ecosite <span class="ot">&lt;-</span> aqp<span class="sc">::</span><span class="fu">site</span>(my.components.MLRA) <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="ecosites.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(repdmu <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ecosite_id))</span></code></pre></div>
<p>Components in nonrep dmus should not be correlated to ecosites. We are going to prepare files that remove these correlations. The process that I have been using to do this is creating to files, ESD Ecosites and ESD Notes. I follow a certain format for those files and email them to Tom Cochrane who uploads them to NASIS.</p>
<p>ESD Ecosite file</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="ecosites.html#cb60-1" aria-hidden="true" tabindex="-1"></a>esd_ecosites_nonrep <span class="ot">&lt;-</span> nonrep_with_ecosite <span class="sc">%&gt;%</span> <span class="fu">select</span>(coiid)</span>
<span id="cb60-2"><a href="ecosites.html#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="ecosites.html#cb60-3" aria-hidden="true" tabindex="-1"></a>esd_ecosites_nonrep<span class="sc">$</span><span class="st">`</span><span class="at">Ecosite ID</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb60-4"><a href="ecosites.html#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="ecosites.html#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(esd_ecosites_nonrep, </span>
<span id="cb60-6"><a href="ecosites.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;C:/Users/Nathan.Roe/Documents/PES4ever/ESD Ecosite_nonrepdmu_20220522.csv&quot;</span>, </span>
<span id="cb60-7"><a href="ecosites.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>ESD Note file</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="ecosites.html#cb61-1" aria-hidden="true" tabindex="-1"></a>esd_notes_nonrep <span class="ot">&lt;-</span> nonrep_with_ecosite <span class="sc">%&gt;%</span> <span class="fu">select</span>(coiid, ecosite_id)</span>
<span id="cb61-2"><a href="ecosites.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="ecosites.html#cb61-3" aria-hidden="true" tabindex="-1"></a>esd_notes_nonrep<span class="sc">$</span>author <span class="ot">&lt;-</span> <span class="st">&quot;Nathan Roe&quot;</span></span>
<span id="cb61-4"><a href="ecosites.html#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="ecosites.html#cb61-5" aria-hidden="true" tabindex="-1"></a>esd_notes_nonrep<span class="sc">$</span>note <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;This site was formerly correlated to &quot;</span>, </span>
<span id="cb61-6"><a href="ecosites.html#cb61-6" aria-hidden="true" tabindex="-1"></a>                          esd_notes_nonrep<span class="sc">$</span>ecosite_id, </span>
<span id="cb61-7"><a href="ecosites.html#cb61-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;. That correlation was removed because this </span></span>
<span id="cb61-8"><a href="ecosites.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="st">                          component belongs to a non-rep dmu and therefore </span></span>
<span id="cb61-9"><a href="ecosites.html#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="st">                          should not be correlated to an ecological site. </span></span>
<span id="cb61-10"><a href="ecosites.html#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="st">                          This change was made by Nathan Roe during the PES </span></span>
<span id="cb61-11"><a href="ecosites.html#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="st">                          initiative of FY2022.&quot;</span>)</span>
<span id="cb61-12"><a href="ecosites.html#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="ecosites.html#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(esd_notes_nonrep <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ecosite_id), </span>
<span id="cb61-14"><a href="ecosites.html#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;C:/Users/Nathan.Roe/Documents/PES4ever/ESD Notes_nonrepdmu_20220522.csv&quot;</span>, </span>
<span id="cb61-15"><a href="ecosites.html#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="components.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="footnotes-and-citations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-ecosites.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
